[![Open in Visual Studio Code](https://classroom.github.com/assets/open-in-vscode-2e0aaae1b6195c2367325f4f02e2d04e9abb55f0b24a779b69b11b9e10269abc.svg)](https://classroom.github.com/online_ide?assignment_repo_id=18835986&assignment_repo_type=AssignmentRepo)
# Лабораторная работа "Свёрточные нейронные сети"

## Задание

1. Решить задачу классификации пород кошек и собак на основе датасета [Pet Faces][PetFaces]. 
![Dataset we will deal with](images/data.png)
2. Решить задачу классификации пород кошек и собак на основе датасета [Oxford Pets] с использованием Transfer Learning. Также [на хорошую и отличную оценку] необходимо визуализировать результаты работы сети для разных классов на разных изображениях с помощью алгоритма [GradCam](https://keras.io/examples/vision/grad_cam/) 
4. Обучить автоэнкодер или генеративно-состязательную сеть для генерации изображений лиц домашних животных [на хорошую и отличную оценку]. 

Отчёт оформляйте в файле [REPORT.md](REPORT.md).

## 1. Pet Faces

Датасет [Pet Faces][PetFaces] представляет собой множество изображений 13 пород кошек и 23 пород собак, по 200 изображений на каждую породу. Изображение центрированы и уменьшены до небольшого размера. 

Вам необходимо обучить свёрточные нейронные сети для решения двух задач классификации:

* Определение кошки или собаки (бинарная классификация)
* Определение породы кошки или собаки (мультиклассовая классификация)

В обоих случаях вам необходимо самостоятельно придумать архитектуру сети, реализовать предобработку входных данных, разделить данные на обучающий и тестовый датасеты с сохранением пропорции по каждому из классов (stratified split).

Для загрузки датасета используйте следующий код:

```python
!wget http://www.soshnikov.com/permanent/data/petfaces.tar.gz
!tar xfz petfaces.tar.gz
!rm petfaces.tar.gz
```

В качестве результата необходимо:

* Посчитать точность классификатора на тестовом датасете
* Посчитать точность двоичной классификации "кошки против собак" на тестовом датасете
* Построить confusion matrix
* Посчитать top-3 accuracy
* **[На хорошую и отличную оценку]** Выполнить оптимизацию гиперпараметров: архитектуры сети, learning rate, количества нейронов и размеров фильтров.

Решение оформите в файле [Faces.ipynb](Faces.ipynb).

## 2. Oxford Pets и Transfer Learing

Решить задачу классификации пород кошек и собак на основе датасета [Oxford-IIIT](https://www.robots.ox.ac.uk/~vgg/data/pets/).

![Dataset we will deal with](images/data.png)

Используйте оригинальный датасет **[Oxford Pets](https://www.kaggle.com/datasets/tanlikesmath/the-oxfordiiit-pet-dataset)** и предобученные сети VGG-16/VGG-19 и ResNet для построения классификатора пород. 

В качестве результата необходимо:

* Обучить три классификатора пород: на основе VGG-16/19 и на основе ResNet.
* Посчитать точность классификатора на тестовом датасете отдельно для каждого из классификаторов, для дальнейших действий выбрать сеть с лучшей точностью
* Посчитать точность двоичной классификации "кошки против собак" такой сетью на тестовом датасете
* Построить confusion matrix
* Посчитать top-3 и top-5 accuracy
* **[На хорошую и отличную оценку]** Выполнить визуализацию зон интереса, на которые "смотрит" нейросеть при определении тех или иных классов, с помощью алгоритма [GradCam](https://keras.io/examples/vision/grad_cam/). Выберите 5 изображений и соответственно 5 классов, и постройте матрицу 5x5 изображений с картами активации. 

Решение оформите в файле [Pets.ipynb](Pets.ipynb).

## 3. Генерация изображений

Натренируйте генеративную модель - автоэнкодер или генеративно-состязательную сеть для генерации изображений животных. Используйте один из датасетов на выбор: Pet Faces или полноценный Oxford Pets. Рекомендуется начинать экспериментировать с изображениями небольшого размера - 64x64 пикселя, и затем посмотреть, получится ли увеличить размер до 128x128 или 256x256.

[PetFaces]: https://www.soshnikov.com/permanent/data/petfaces.tar.gz
